{% extends 'base.html' %}

{% block title %}–ú–æ—ë —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ{% endblock %}

{% block content %}
<h1 class="mb-4">–ú–æ—ë —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</h1>

<form method="get" class="row g-3 align-items-end mb-4">
  <div class="col-md-4">
    <label class="form-label">–§–∏–ª—å—Ç—Ä –ø–æ –ø—Ä–µ–¥–º–µ—Ç—É</label>
    <select name="subject" class="form-select">
      <option value="" {% if not selected_subject %}selected{% endif %}>–í—Å–µ –ø—Ä–µ–¥–º–µ—Ç—ã</option>
      <option value="–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞" {% if selected_subject == "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞" %}selected{% endif %}>–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞</option>
      <option value="–§–∏–∑–∏–∫–∞" {% if selected_subject == "–§–∏–∑–∏–∫–∞" %}selected{% endif %}>–§–∏–∑–∏–∫–∞</option>
      <option value="–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞" {% if selected_subject == "–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞" %}selected{% endif %}>–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞</option>
    </select>
  </div>

  <div class="col-md-3">
    <label class="form-label">–§–∏–ª—å—Ç—Ä –ø–æ –¥–∞—Ç–µ</label>
    <input type="date" name="date" class="form-control" value="{{ selected_date }}">
  </div>

  <div class="col-md-3">
    <label class="form-label">–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏</label>
    <input type="text" name="name" class="form-control" placeholder="–ò–º—è —É—á–µ–Ω–∏–∫–∞" value="{{ selected_name }}">
  </div>

  <div class="col-md-2 text-end">
    <button type="submit" class="btn btn-primary w-100">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
  </div>
</form>

<div class="mb-3">
  <a href="{{ url_for('export_schedule_excel', subject=selected_subject, name=selected_name, date=selected_date) }}"
     class="btn btn-outline-success me-2">üì• –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel</a>
  <a href="{{ url_for('export_schedule_pdf', subject=selected_subject, name=selected_name, date=selected_date) }}"
     class="btn btn-outline-danger">üì• –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF</a>
</div>

{% if schedule %}
  <div class="table-responsive">
    <table class="table table-bordered table-striped align-middle">
      <thead class="table-light">
        <tr>
          <th>–î–∞—Ç–∞</th>
          <th>–í—Ä–µ–º—è</th>
          <th>–ü—Ä–µ–¥–º–µ—Ç</th>
          <th>–£—á–µ–Ω–∏–∫</th>
          <th>Email</th>
          <th>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
        </tr>
      </thead>
      <tbody>
        {% for entry in schedule %}
        <tr>
          <td>{{ entry.preferred_date }}</td>
          <td>{{ entry.preferred_time[:5] }}</td>
          <td>{{ entry.subject }}</td>
          <td>{{ entry.name }}</td>
          <td>{{ entry.email }}</td>
          <td>{{ entry.message }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% else %}
  <p class="text-muted">–ó–∞–ø–∏—Å–µ–π –ø–æ–∫–∞ –Ω–µ—Ç.</p>
{% endif %}
{% endblock %}
